#--!/usr/bin/env python3
#-- -*- coding: Latin-1 -*-
#--
#-- *************************************************************************************************************:
#-- ******************************************** VULNERABILITY SCANNER ******************************************:
#-- *************************************************************************************************************:
#-- Author:   JBALLARD (JEB)                                                                                     :
#-- Date:     2015.11.06                                                                                         :
#-- Script:   SYS-VULNERABILITY.SCAN.py                                                                          :
#-- Purpose:  A python script that scans for Vulnerabilities on system ports.                                    :
#-- Version:  1.0                                                                                                :
#-- *************************************************************************************************************:
#-- *************************************************************************************************************:
#--
#-- *************************************************:
#-- DEFINE PARAMS, CONFIG PATHS, IMPORT CLASSES      :
#-- *************************************************:
import socket
import subprocess
import sys
from datetime import datetime
#--
#-- CLEAR COMMAND SCREEN:
subprocess.call('CLEAR', shell=True)
#--
#-- CONFIGURE SYSTEM NAME OR IP:
REMSvr    = "10.165.2.40"
REMSvrIP  = socket.gethostbyname(REMSvr)
#--
#-- BUILD COMMAND LINE BANNER:
print ("-" * 60)
print ("SCANNING SYSTEM PORTS, PLEASE WAIT...", REMSvrIP)
print ("-" * 60)
#--
#-- TIME PORT SCAN STARTED:
T1 = datetime.now()
try:
    for port in range(1,1025):  
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        result = sock.connect_ex((REMSvrIP, port))
        if result == 0:
            print ("PORT {}: 	 OPEN".format(port))
        sock.close()
#--
except KeyboardInterrupt:
    print ("USER INTERRUPTED SCRIPT:")
    sys.exit()
#--
except socket.gaierror:
    print ('FAILED TO RESOLVE HOST NAME, EXIT SCRIPT:')
    sys.exit()
#
except socket.error:
    print ("FAILED TO CONNECT TO SYSTEM:")
    sys.exit()
#--
#-- CHECK TIME:
T2 = datetime.now()
#--
#-- CALCULATE TIME DIFF:
TOTAL =  T2 - T1
#--
#-- DISPLAY INFO COMMAND LINE:
print ('COMPLETED SCAN IN: ', TOTAL)
#--
#-- *************************************************:
#-- END OF PYTHON SCRIPT                             :
#-- *************************************************:
